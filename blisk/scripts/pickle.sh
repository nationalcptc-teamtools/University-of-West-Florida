#!/bin/zsh
echo '
MWWNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNWM
WNNNXKK000KK000000KKKKKK0KKK00KKKKKKKKKKKKK0000KKKKKKKKK0000000KKXNNNW
NNWKdlccclolcccccccllcllccllcccloollllllllccclllllllllllccccccllco0WNN
NNW0l:cok0K0o:::::clcccc::ccccccccccccccclcclccc:cllllllc::cccccclOWNN
NNW0l:cldKNOl:::::clc:cc:::::ccclccccccccccclc::::llllllccccccccccOWNN
NNW0oodolOXxc:::::clc:cc::::::::::::ccccc::ccclccccclllolcccccccclOWNN
NNW0oxKKk0Kdc:::::clcccc:::::::::cccclcccc:::ccccc::llllllcccccccckWNN
NNW0lcok0Okl::::::cllccc:::::::ccloooooooolc:::::::cllc:::ccccc:ccOWNN
NNW0ooOOxk0kl:::::cll:cc:::::ccloollc::::codoc:::cccc::::cccc::cclOWNN
NNW0oONkccOXxc::::clcccc:::ccldol::;;::coxkOkocccccc:::ccccc:clccckWNN
NNW0oxKOdd00o:::::cccccc:ccclodc:::;;;:lO0OO0kocc::::cccc::::llc:ckWNN
NNW0lcokOOkdlc:::::::::cccccodc:::::;;:cx00Okoc::::cccc::::::llccckWNN
NNW0ooOKkdk0xl::::cloodddolodc::::::::::cdkxdoooooolc::::::::looooOWNN
NNW0lcONK0Kxl:::coddddddddxdc::::::::::::cdxddddddxdoc:::::::looooOWNN
NNW0lcONKO0Ol::coxdooooooolc::::::::::::::clooooooodxoc::::::lllllkWNN
NNW0oo0XOokXklcoxdoodddoolc::::::;:::;::;::cloodddoodxoc::ccclllllOWNN
NNW0odO0OkO0xllxxodxdoddoc::;::::::cc:::;:::coxdodxdoxxc::clllllloOWNN
NNW0ll0N0xOOdldOkdkkl:lxo:::clodxkkkkxdolc:::oxl:lxkdkkoc:ccccccclOWNN
NNW0lcON0xxoccx0OOOOocodc::coxkOOOOOOOOkxoc::cdocoOOOOOxc::::::::ckWNN
NNW0ll0NkoxkocldkOxoclxo::lod:::xO00Okk:::llc:oxlcoxkkdl:::::::::ckWNN
NNW0odO0OO0Oo::cclc::ldocldxkxxxxOOOOkOOdoxkdcodl::cllcccccccccccckWNN
NNW0ooOKOxOOo::::::::cdxdd:kOkkkkOOOkkkOOOO:kkxxoc::cllllldkxodOOdoOWN
NNW0lcONkoO0dc:::::ccokkxd::::::::::::::::::ook0Oxl::clllllKk0N0doOWNN
NNW0lcON0OKOl::::cccccoxxxoc::cloooooolc::cdOOkdc::cllclld00k0NOlo0WNN
NNW0ooOKxlO0d::cccc:::cldkkdl::dO0000Od::lkOOdl::::clc::cd0kokN0ll0WNN
NNW0lcllccooccccc:::::ccoxkxxo::::::::::dkOOxolcc::llc:::lxOOO0Odo0WNN
NNW0lc:::cllclc::cclodddddddxkkxddddddxkkkkxxdxddololc:::oOkxOKOoo0WNN
NNWOlcccccllllcloddddddooddxxxxxkkkkkkxxxddxxdddddxxxolc:coooONOcl0WNN
NNWOllllclollloddoooodddxxxxdoooddxxxxdoodddxxxxxdddddxoccdxx0NOcl0WNN
NNWkccll:clloxxdllodddxxxddooooddddddxxdooooddddxxxdoodxddOkxOKOoo0WNN
NNWkccll:cllokxlccclodxxdooooollcccccloddooooddddolcccoxxxOkdk0Odo0WNN
NNWkccll:clloxdlcccloxxdoooolcc:cllllccclooooodxdolcccodoxK0x0NOll0WNN
NNWkc:ll:clloxdccodoooxxololc:cloooooolc:coooodxooodxkOdccd0KXNOcl0WNN
NNWkccll:clloxdlodoc:lxxoolc:codl::::ldoccclooxxl:coOK0xld00k0N0ol0WNN
NNWkccll:cllllloolc::ldxollcloocc::::ccoolclloxdl::lddocldxdxOOxoo0WNN
NNWkccll:cllll:::::::cxOOdoool::::::::::coddlcddc::llc:::lxOkkOxll0WNN
NNWkc:ll:cllll:::::::cx0K0klc:::::::::::::odolodc::llc:::xXOlckXko0WNN
NNWOlcllccllllcccccccclddolcccccccccccc:::clodolcccclc:::dK0olOKxo0WNN
NNWOolllllllllllllllllllcccclllllllllllcccclccccccclcccc:cokkkkdcl0WNN
NNW0doolllolllllcccllooccodddddollllllcllcc::::::::ccllccclxOO0klo0WNN
NNW0oolllcllllc:::::cllllloodddolllllllooc:::::::::::llcclkX0dk0xo0WNN
NNWOlllllcllll:::::::clllllloooollllllodolc:::::::::cllc:cxN0lcccl0WNN
NNWOlllllcllllc::::::clllllllccllllllcloollcccccccllccc::o0NXOoc:l0WNN
NNWOlllllcllcccccccccccclllllccllllllcc:::c::c:::cc::::::ldddoccco0WNN
NNWXOkxdxxxxxxdxxxxxxxxkkxxxxxxxxxkkkkxdddddddddddddddddddddddddxONWNN
MNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNWM
MMWWNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNWMMM

'
# the big install
sudo DEBIAN_FRONTEND=noninteractive apt update -y -qq > /dev/null 2>&1
sudo DEBIAN_FRONTEND=noninteractive apt install -y -qq masscan curl terminator git python3-dev faketime apt-transport-https ca-certificates gnupg lsb-release build-essential pkg-config libssl-dev libkrb5-dev libclang-dev clang libgssapi-krb5-2 krb5-user cifs-utils > /dev/null 2>&1

# docker
curl -fsSL https://download.docker.com/linux/debian/gpg | sudo gpg --dearmor -o /usr/share/keyrings/docker-archive-keyring.gpg
echo "deb [arch=$(dpkg --print-architecture) signed-by=/usr/share/keyrings/docker-archive-keyring.gpg] https://download.docker.com/linux/debian bullseye stable" | sudo tee /etc/apt/sources.list.d/docker.list > /dev/null
sudo DEBIAN_FRONTEND=noninteractive apt update -y -qq > /dev/null 2>&1
sudo DEBIAN_FRONTEND=noninteractive apt install -y -qq docker-ce docker-ce-cli containerd.io docker-buildx-plugin docker-compose-plugin > /dev/null 2>&1
sudo curl -sSL "https://github.com/docker/compose/releases/latest/download/docker-compose-$(uname -s)-$(uname -m)" -o /usr/local/bin/docker-compose
sudo chmod +x /usr/local/bin/docker-compose
sudo systemctl start docker
sudo systemctl enable docker > /dev/null 2>&1
sudo usermod -aG docker $USER

# rustup
curl https://sh.rustup.rs -sSf | sh -s -- -y > /dev/null 2>&1
source "$HOME/.cargo/env"

# uv and tools
curl -LsSf https://astral.sh/uv/install.sh | sh > /dev/null 2>&1
export PATH="$HOME/.local/bin:$PATH"
echo 'export PATH="$HOME/.local/bin:$PATH"' >> ~/.zshrc
uv tool install git+https://github.com/Pennyw0rth/NetExec.git -q
uv tool install git+https://github.com/ly4k/Certipy.git -q
uv tool install git+https://github.com/fortra/impacket.git -q
uv tool install git+https://github.com/CravateRouge/bloodyAD.git -q
uv tool install git+https://github.com/dirkjanm/BloodHound.py.git@bloodhound-ce -q
uv tool install git+https://github.com/adityatelange/evil-winrm-py -q

# shell
sh -c "$(curl -fsSL https://raw.githubusercontent.com/ohmyzsh/ohmyzsh/master/tools/install.sh) --unattended" >/dev/null 2>&1
git clone -q https://github.com/zsh-users/zsh-autosuggestions.git ${ZSH_CUSTOM:-~/.oh-my-zsh/custom}/plugins/zsh-autosuggestions
git clone -q https://github.com/zsh-users/zsh-syntax-highlighting.git ${ZSH_CUSTOM:-~/.oh-my-zsh/custom}/plugins/zsh-syntax-highlighting
git clone -q https://github.com/zdharma-continuum/fast-syntax-highlighting ${ZSH_CUSTOM:-~/.oh-my-zsh/custom}/plugins/fast-syntax-highlighting
sed -i 's/^plugins=(git)$/plugins=(git zsh-syntax-highlighting zsh-autosuggestions fast-syntax-highlighting)/' ~/.zshrc
sed -i 's/robbyrussell/minimal/g' ~/.zshrc

# rusthound
cargo install --quiet rusthound-ce
echo 'export PATH="$HOME/.cargo/bin:$PATH"' >> ~/.zshrc

# rockyou
curl -sSLo ~/rockyou.txt https://github.com/brannondorsey/naive-hashcat/releases/download/data/rockyou.txt

# bloodhound setup
mkdir -p ~/bloodhound
curl -sSLo ~/bloodhound/docker-compose.yml https://ghst.ly/getbhce
sg docker -c 'docker-compose -f ~/bloodhound/docker-compose.yml pull -q'
sg docker -c '
BLOODHOUND_HOST=0.0.0.0 BLOODHOUND_PORT=8888 docker-compose -f ~/bloodhound/docker-compose.yml up -d

echo "Girls are now preparing BloodHound, please wait warmly... â˜¯"
until curl -s -f http://localhost:8888 >/dev/null 2>&1; do
    echo -n "."
    sleep 2
done
echo " Ready!"

'
sg docker -c 'echo $(docker logs $(docker ps -qf "ancestor=specterops/bloodhound:latest") | grep -i "initial password") | cut -d# -f2'
source ~/.zshrc
